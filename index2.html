<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Symposium</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom styles */
        body {
            font-family: 'Cormorant', serif;
            background-color: #fdfbf7; /* Light, airy off-white */
            color: #666666; /* Soft grey text */
            overscroll-behavior-y: contain; /* Prevents scroll bounce */
        }
        .font-romantic {
            font-family: 'Cormorant', serif;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        .hero-section {
            background-image: url('symv2imgs/img.jpg');
            background-size: cover;
            background-position: center;
            filter: brightness(1.1); /* Brighten the background image */
            position: relative;
        }
        
        /* On screens wider than 1000px, shift the background image position down slightly */
        @media (min-width: 1001px) {
            .hero-section {
                background-position: center 20%;
            }
        }
        
        /* Animation for the scrolling reviews */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .scrolling-wrapper-fast {
            display: flex;
            animation: scroll 35s linear infinite;
        }

        .scrolling-wrapper-slow {
            display: flex;
            animation: scroll 55s linear infinite;
            animation-delay: -10s; /* Offset the start */
        }
        
        /* Faster scrolling on mobile */
        @media (max-width: 768px) {
            .scrolling-wrapper-fast {
                animation-duration: 25s;
            }
            .scrolling-wrapper-slow {
                animation-duration: 40s;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Hero Section -->
    <header class="hero-section flex flex-col items-center justify-center text-white text-center p-4 h-[80vh] md:h-[95vh]">
        <div class="absolute inset-0 bg-black opacity-30"></div>
        <h1 class="font-romantic text-6xl md:text-8xl lg:text-9xl z-10" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.7);">
            Love Symposium
        </h1>
        <p class="z-10 mt-4 text-lg md:text-xl lg:text-2xl tracking-wider text-gray-200">
            The Weekend of November 14-16 at 
            <a href="https://www.google.com/maps/search/?api=1&query=The+Commons,San+Francisco,CA" target="_blank" rel="noopener noreferrer" class="inline-block bg-white/20 hover:bg-white/40 text-white font-semibold px-4 py-1 rounded-full transition duration-300 mx-1">The Commons, San Francisco</a>
        </p>
    </header>

    <!-- Main Content Container -->
    <div class="bg-[#fdfbf7] relative">
        <!-- Decorative Divider -->
        <div class="absolute top-0 left-0 right-0 h-20 -translate-y-1/2 z-10 flex items-center justify-center pointer-events-none">
            <svg class="w-full h-full" viewBox="0 0 1200 100" preserveAspectRatio="none">
                <path d="M0 50 Q 150 100, 300 50 T 600 50 T 900 50 T 1200 50" stroke="#5c323e" stroke-width="2" fill="none" />
                <path d="M0 50 Q 150 0, 300 50 T 600 50 T 900 50 T 1200 50" stroke="#5c323e" stroke-width="2" fill="none" />
            </svg>
        </div>

        <!-- Buttons Section -->
        <div class="text-center pt-20 relative z-20">
            <a href="#tickets" class="inline-block mx-2 px-8 py-4 bg-white text-[#5c323e] font-bold rounded-full text-lg hover:bg-gray-200 transition duration-300 shadow-lg">Buy Tickets</a>
            <a href="#schedule" class="inline-block mx-2 px-8 py-4 bg-[#5c323e] text-white font-bold rounded-full text-lg hover:bg-opacity-80 transition duration-300 shadow-lg">Schedule</a>
        </div>

        <!-- Speaker Grid -->
        <main id="speakers-section" class="container mx-auto px-4 pt-16 pb-12 relative z-10">
            <!-- Speaker profiles inserted here -->
        </main>
        
        <!-- Interspersed Image Divider -->
        <div class="flex justify-center py-16">
            <img src="symv2imgs/1.png" alt="Decorative flourish" class="max-w-xs md:max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/600x200/fdfbf7/666666?text=Flourish'">
        </div>

        <!-- Letter from the Hosts Section -->
        <section class="container mx-auto px-4 py-16 md:py-24">
            <h2 class="text-4xl md:text-5xl font-romantic text-center mb-16 text-[#5c323e]">A Letter From The Hosts</h2>
            <div id="hosts-section" class="flex flex-col md:flex-row gap-12 md:gap-8 items-start">
                <!-- Hosts content inserted here -->
            </div>
        </section>

        <!-- Interspersed Image Divider -->
        <div class="flex justify-center py-16">
            <img src="symv2imgs/2.png" alt="Decorative flourish" class="max-w-xs md:max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/600x200/fdfbf7/666666?text=Flourish'">
        </div>

        <!-- Scrolling Reviews Section -->
        <section class="py-16 md:py-24 bg-white">
            <h2 class="text-4xl md:text-5xl font-romantic text-center mb-12 text-[#5c323e]">Words of Love</h2>
            <div class="relative w-full overflow-hidden space-y-4" style="mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);">
                 <div id="reviews-container-top" class="scrolling-wrapper-fast">
                    <!-- Reviews inserted here -->
                 </div>
                 <div id="reviews-container-bottom" class="scrolling-wrapper-slow">
                    <!-- Reviews inserted here -->
                 </div>
            </div>
        </section>

        <!-- Interspersed Image Divider -->
        <div class="flex justify-center py-16">
            <img src="symv2imgs/3.png" alt="Decorative flourish" class="max-w-xs md:max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/600x200/fdfbf7/666666?text=Flourish'">
        </div>

        <!-- Tickets Section -->
        <section id="tickets" class="container mx-auto px-4 py-16 md:py-24">
            <h2 class="text-4xl md:text-5xl font-romantic text-center mb-12 text-[#5c323e]">Tickets</h2>
            <div id="tickets-grid" class="grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <!-- Ticket options inserted here -->
            </div>
        </section>

        <!-- Interspersed Image Divider -->
        <div class="flex justify-center py-16">
            <img src="symv2imgs/4.png" alt="Decorative flourish" class="max-w-xs md:max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/600x200/fdfbf7/666666?text=Flourish'">
        </div>

        <!-- FAQ Section -->
        <section class="container mx-auto px-4 py-16 md:py-24 max-w-4xl">
            <h2 class="text-4xl md:text-5xl font-romantic text-center mb-12 text-[#5c323e]">Frequently Asked Questions</h2>
            <div id="faq-container" class="space-y-8">
                <!-- FAQ items inserted here -->
            </div>
        </section>
        
        <!-- Interspersed Image Divider -->
        <div class="flex justify-center py-16">
            <img src="symv2imgs/5.png" alt="Decorative flourish" class="max-w-xs md:max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/600x200/fdfbf7/666666?text=Flourish'">
        </div>

        <!-- Schedule Section -->
        <section id="schedule" class="bg-white py-16 md:py-24">
            <div class="container mx-auto px-4">
                <h2 class="text-4xl md:text-5xl font-romantic text-center mb-12 text-[#5c323e]">Symposium Schedule</h2>
                <div id="schedule-container" class="space-y-16">
                    <!-- Schedule days inserted here -->
                </div>
            </div>
        </section>

        <!-- Contact Form Section -->
        <section class="container mx-auto px-4 py-16 md:py-24">
            <h2 class="text-4xl md:text-5xl font-romantic text-center mb-12 text-[#5c323e]">Get In Touch</h2>
            <form class="max-w-xl mx-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <input type="text" placeholder="Your Name" class="w-full p-3 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#8dafb9]">
                    <input type="email" placeholder="Your Email" class="w-full p-3 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#8dafb9]">
                </div>
                <textarea placeholder="Your Message" rows="6" class="w-full p-3 bg-white border border-gray-300 rounded-lg mb-6 focus:outline-none focus:ring-2 focus:ring-[#8dafb9]"></textarea>
                <button type="submit" class="w-full text-center text-white font-bold py-3 px-6 rounded-lg bg-[#5c323e] hover:bg-opacity-80 transition duration-300">Send Message</button>
            </form>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-[#5c323e] text-white text-center p-8">
        <p>Â© 2025 Love Symposium. All Rights Reserved.</p>
    </footer>

    <!-- Debug Toggles -->
    <div id="debug-panel" class="fixed bottom-4 right-4 z-50"></div>


    <script>
        // =====================================================================
        // SETTINGS
        // =====================================================================
        
        let debugMode = true; 
        let showTeaserMode = true; 

        // =====================================================================
        // DATA URLs
        // =====================================================================
        const dataUrls = {
            speakers: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQuSLC5kKYfcrLYQIi7IqgpXY5I-t2lu7ztNicu3bcpHFtgWrJPvIo9L0fR05GH3WMJO540vTi5wWXl/pub?gid=0&single=true&output=csv',
            schedule: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQuSLC5kKYfcrLYQIi7IqgpXY5I-t2lu7ztNicu3bcpHFtgWrJPvIo9L0fR05GH3WMJO540vTi5wWXl/pub?gid=1770951979&single=true&output=csv',
        };
        const fallbackUrls = {
            speakers: 'symv2imgs/speakers.csv',
            schedule: 'symv2imgs/schedule.csv',
        };

        // =====================================================================
        // GLOBAL DATA VARIABLES
        // =====================================================================
        let allSpeakers = [];
        let allScheduleData = [];

        // =====================================================================
        // LOCAL DATA SOURCES (FALLBACKS & OTHERS)
        // =====================================================================
        
        const localSpeakers = [
            { "Index": "0", "Name": "Whitney Wolfe Herd", "Title": "Tinder and Bumble Founder", "Image URL": "https://i.insider.com/602d50a25843000018456a23?width=1136&format=jpeg", "Social Media Link": "#", "Confirmed?": "1" },
            { "Index": "1", "Name": "Justin McLeod", "Title": "Founder & CEO, Hinge", "Image URL": "https://cdn.sanity.io/images/z342s4t3/production/d34a6e3e117f0845347204b759639f77f0c13745-1200x800.jpg?w=1200&h=800&auto=format", "Social Media Link": "#", "Confirmed?": "1" },
        ];

        const localSchedule = [];

        const hosts = [
            { name: 'Ann Pierce', image: 'symv2imgs/ann.jpg', statement: 'Our mission is to create a space where modern love can be explored in all its facets. We believe that by bringing together diverse voices and fostering open dialogue, we can all learn to love more deeply and authentically.' },
            { name: 'Matthew Fisher', image: 'symv2imgs/matt.jpg', statement: 'Love is the cornerstone of the human experience, yet we rarely give it the academic and intentional focus it deserves. This symposium is our answerâa chance to learn, share, and grow together in our understanding of connection.' }
        ];

        const reviews = [
            { name: 'Humberto Moreira', image: 'https://placehold.co/100x100/ffb6c1/FFFFFF?text=H', text: 'An absolutely transformative experience. I left with a new perspective on my relationships.' },
            { name: 'Alex Chen', image: 'https://placehold.co/100x100/87ceeb/FFFFFF?text=A', text: 'The quality of speakers was phenomenal. So much wisdom in one place.' },
            { name: 'Alok Singh', image: 'https://placehold.co/100x100/98fb98/FFFFFF?text=A', text: 'I attended with my partner, and it was the best decision we\'ve made for our relationship all year.' },
            { name: 'Thomas Vu', image: 'https://placehold.co/100x100/dda0dd/FFFFFF?text=T', text: 'Finally, a conference that treats love with the intellectual respect it deserves.' },
            { name: 'Kincaid O\'Neil', image: 'https://placehold.co/100x100/f0e68c/FFFFFF?text=K', text: 'I felt so seen and understood. The sense of community was palpable.' },
            { name: 'Suzie Antal', image: 'https://placehold.co/100x100/add8e6/FFFFFF?text=S', text: 'Incredibly well-organized and profoundly insightful. I will be back next year!' },
            { name: 'Ari Zerner', image: 'https://placehold.co/100x100/b0c4de/FFFFFF?text=A', text: 'A must-attend for anyone interested in the future of human connection.' },
            { name: 'Ben Carter', image: 'https://placehold.co/100x100/A9A9A9/FFFFFF?text=B.C.', text: 'The best investment I\'ve made in my personal growth this year.' },
            { name: 'Olivia Kim', image: 'https://placehold.co/100x100/696969/FFFFFF?text=O.K.', text: 'The topics were so relevant and the discussions were incredibly engaging.' },
            { name: 'Gabriel Santos', image: 'https://placehold.co/100x100/808080/FFFFFF?text=G.S.', text: 'A truly inspiring weekend. I can\'t wait for the next one.' },
        ];

        const tickets = [
            { name: 'Early Bird', price: 99, features: ['Full Access to All Talks', 'Digital Welcome Packet', 'Community Forum Access'], cta: 'Buy Now', highlight: false },
            { name: 'Late In Love', price: 150, features: ['Full Access to All Talks', 'Digital Welcome Packet', 'Community Forum Access', 'Recording of All Sessions'], cta: 'Buy Now', highlight: false },
            { name: 'Sponsor', price: 2000, features: ['All-Access VIP Pass', 'Special Mention in Program', 'Private Q&A with Hosts', 'Logo Placement on Site'], cta: 'Become a Sponsor', highlight: true }
        ];

        const faqData = [
            { question: "What is the venue for the symposium?", answer: "The symposium will be held at <strong>The Commons</strong>, a beautiful and spacious venue perfect for fostering connection and learning." },
            { question: "What catering is provided?", answer: "We are pleased to offer the following catering: <ul><li class='ml-4 list-disc'>Friday: Lunch</li><li class='ml-4 list-disc'>Saturday: Breakfast and Lunch</li><li class='ml-4 list-disc'>Sunday: Breakfast</li></ul>" },
            { question: "Is there a dress code?", answer: "We recommend smart casual attire. Comfort is key, as the days will be full of learning and interaction." },
            { question: "Can I get a refund on my ticket?", answer: "Tickets are non-refundable but are transferable. Please contact us with the new attendee's information at least one week prior to the event." }
        ];

        // =====================================================================
        // DATA FETCHING & PARSING
        // =====================================================================

        async function fetchAndParseCsv(primaryUrl, fallbackUrl, parser) {
            try {
                const response = await fetch(primaryUrl);
                if (!response.ok) throw new Error('Primary URL fetch failed');
                const csvText = await response.text();
                console.log(`Successfully fetched data from PRIMARY source: ${primaryUrl}`);
                console.log("Raw CSV:\n", csvText);
                return parser(csvText);
            } catch (e) {
                console.warn(`Primary fetch failed: ${e.message}. Trying fallback URL: ${fallbackUrl}`);
                try {
                    const response = await fetch(fallbackUrl);
                    if (!response.ok) throw new Error('Fallback URL fetch failed');
                    const csvText = await response.text();
                    console.log(`Successfully fetched data from FALLBACK source: ${fallbackUrl}`);
                    console.log("Raw CSV:\n", csvText);
                    return parser(csvText);
                } catch (e2) {
                    console.error(`Fallback fetch also failed: ${e2.message}.`);
                    return [];
                }
            }
        }

        function parseSpeakersCsv(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[1].split(',').map(h => h.trim().replace(/"/g, ''));
            const data = lines.slice(2).map(line => {
                const values = line.split(',');
                return headers.reduce((obj, header, i) => {
                    if (header) obj[header] = (values[i] || '').trim().replace(/"/g, '');
                    return obj;
                }, {});
            });
            console.log("Parsed Speakers Data:", data);
            return data;
        }

        function parseScheduleCsv(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const data = lines.slice(1).map(line => {
                const values = line.split(',');
                return headers.reduce((obj, header, i) => {
                    if (header) obj[header] = (values[i] || '').trim().replace(/"/g, '');
                    return obj;
                }, {});
            });
            console.log("Parsed Schedule Data:", data);
            return data;
        }

        // =====================================================================
        // DOM POPULATION & RENDERING
        // =====================================================================

        function renderPage() {
            populateSpeakers(allSpeakers);
            populateSchedule(allScheduleData, allSpeakers);
            populateHosts(hosts);
            populateReviews(reviews);
            populateTickets(tickets);
            populateFaq(faqData);
        }

        function populateSpeakers(speakers) {
            const speakersSection = document.getElementById('speakers-section'); 
            if (!speakersSection) return; 

            const confirmedSpeakers = speakers.filter(s => s['Confirmed?'] === '1');

            if (showTeaserMode || confirmedSpeakers.length === 0) {
                speakersSection.innerHTML = `
                    <div class="text-center py-24 bg-blue-50 rounded-lg">
                        <h3 class="text-4xl font-romantic text-[#5c323e] mb-4">World-Renowned Speakers</h3>
                        <p class="text-2xl text-gray-500">are being confirmed.</p>
                        <p class="text-lg text-gray-500 mt-2">Check back soon for our incredible lineup of thinkers and builders!</p>
                    </div>`;
            } else {
                speakersSection.innerHTML = `<div id="speaker-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-6 md:gap-8"></div>`;
                const grid = document.getElementById('speaker-grid');
                if (!grid) return;
                grid.innerHTML = ''; 
                confirmedSpeakers.forEach(speaker => { 
                    const card = `<div class="flex flex-col items-center text-center"><img src="${speaker['Image URL']}" alt="Profile of ${speaker.Name}" class="w-24 h-24 md:w-28 md:h-28 rounded-full object-cover border-4 border-white shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/200x200/cccccc/ffffff?text=Image+Not+Found'"><a href="${speaker['Social Media Link'] || '#'}" class="mt-4 font-bold text-[#5c323e] hover:text-[#8dafb9] transition">${speaker.Name}</a><p class="text-sm text-gray-500">${speaker.Title}</p></div>`; 
                    grid.innerHTML += card; 
                });
            }
        }
        
        function populateHosts(hostsData) {
            const section = document.getElementById('hosts-section');
            if (!section) return;
            section.innerHTML = '';
            hostsData.forEach((host, index) => {
                const alignmentClass = index === 0 
                    ? 'md:items-end md:text-right' 
                    : 'md:items-start md:text-left';

                const content = `
                    <div class="flex flex-col items-center text-center w-full md:w-1/2 ${alignmentClass}">
                        <img src="${host.image}" alt="Photo of ${host.name}" class="w-32 h-32 rounded-full object-cover border-4 border-white shadow-xl mb-6" onerror="this.onerror=null;this.src='https://placehold.co/300x300/cccccc/ffffff?text=Image+Not+Found'">
                        <h3 class="text-2xl font-bold mb-2 text-[#5c323e]">${host.name}</h3>
                        <p class="text-gray-600 leading-relaxed max-w-md">${host.statement}</p>
                    </div>
                `;
                section.innerHTML += content;
            });
        }

        function populateReviews(reviewsData) {
            const topContainer = document.getElementById('reviews-container-top');
            const bottomContainer = document.getElementById('reviews-container-bottom');
            if (!topContainer || !bottomContainer) return; 
            
            const allReviews = [...reviewsData, ...reviewsData, ...reviewsData, ...reviewsData]; 
            topContainer.innerHTML = '';
            bottomContainer.innerHTML = '';

            allReviews.forEach(review => { 
                const card = `<div class="flex-shrink-0 w-80 mx-4 p-6 bg-gray-50 rounded-lg shadow-md flex items-start"><img src="${review.image}" alt="Photo of ${review.name}" class="w-12 h-12 rounded-full object-cover mr-4 border-2 border-white" onerror="this.onerror=null;this.src='https://placehold.co/100x100/cccccc/ffffff?text=Error'"><div><p class="font-semibold text-[#5c323e]">${review.name}</p><p class="text-gray-600 italic">"${review.text}"</p></div></div>`; 
                topContainer.innerHTML += card;
                bottomContainer.innerHTML += card;
            });
        }

        function populateTickets(ticketsData) {
            const grid = document.getElementById('tickets-grid'); if (!grid) return; grid.innerHTML = '';
            ticketsData.forEach(ticket => { 
                const highlight = String(ticket.highlight).toLowerCase() === 'true';
                const highlightClass = highlight ? 'border-[#d9bb89] border-2' : 'border-gray-200'; 
                const buttonClass = highlight ? 'bg-[#d9bb89] text-[#5c323e]' : 'bg-[#5c323e] text-white'; 
                const featuresArray = Array.isArray(ticket.features) ? ticket.features : (ticket.features || '').split(';');
                const card = `<div class="rounded-lg shadow-lg p-8 flex flex-col bg-white border ${highlightClass}"><h3 class="text-2xl font-bold text-center text-[#5c323e]">${ticket.name}</h3><p class="text-5xl font-bold text-center my-4 text-gray-800">$${ticket.price}</p><ul class="my-4 space-y-2 flex-grow text-gray-600">${featuresArray.map(feature => `<li class="flex items-center"><svg class="w-5 h-5 text-[#8dafb9] mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>${feature}</li>`).join('')}</ul><a href="#" class="w-full text-center font-bold py-3 px-6 rounded-lg ${buttonClass} hover:bg-opacity-80 transition duration-300 mt-6">${ticket.cta}</a></div>`; 
                grid.innerHTML += card; 
            });
        }
        
        function populateFaq(faqData) {
            const container = document.getElementById('faq-container');
            if (!container) return;
            container.innerHTML = '';
            faqData.forEach(item => {
                const faqItem = `
                    <div>
                        <h3 class="text-xl font-bold mb-2 text-[#5c323e]">${item.question}</h3>
                        <div class="text-gray-600 leading-relaxed">${item.answer}</div>
                    </div>
                `;
                container.innerHTML += faqItem;
            });
        }

        function populateSchedule(schedule, speakers) {
            const container = document.getElementById('schedule-container');
            if (!container) return;
            container.innerHTML = '';

            if (showTeaserMode || !schedule || schedule.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-24 bg-blue-50 rounded-lg">
                        <h3 class="text-4xl font-romantic text-[#5c323e] mb-4">The Full Schedule</h3>
                        <p class="text-2xl text-gray-500">is being perfected.</p>
                        <p class="text-lg text-gray-500 mt-2">Check back soon for the full lineup of talks and workshops!</p>
                    </div>`;
                return;
            }

            const scheduleByDay = schedule.reduce((acc, row) => {
                if (!row.Date) return acc; 
                const date = row.Date;
                if (!acc[date]) acc[date] = { date, slots: [] };
                
                const getSpeaker = (id) => {
                    if (!id) return null;
                    if (id === 'host_0') return hosts[0];
                    if (id === 'host_1') return hosts[1];
                    return speakers.find(s => s.Index === id);
                };

                const parseContent = (content) => {
                    if (!content || !content.includes('|')) return { talk: content, speaker: null };
                    const [talk, speakerIndex] = content.split('|');
                    return { talk, speaker: getSpeaker(speakerIndex) };
                };

                acc[date].slots.push({
                    time: row.Time,
                    rooms: [
                        { ...parseContent(row['Room 1 Content']), name: row['Room 1 Name'] },
                        { ...parseContent(row['Room 2 Content']), name: row['Room 2 Name'] }
                    ]
                });
                return acc;
            }, {});

            Object.values(scheduleByDay).forEach(day => {
                const room1Name = day.slots[0]?.rooms[0]?.name || 'Room 1';
                const room2Name = day.slots[0]?.rooms[1]?.name || 'Room 2';

                let dayHtml = `<div class="day-schedule">
                        <div class="sticky top-0 bg-white z-20">
                            <h3 class="text-3xl font-bold pt-4 pb-2 text-center text-[#5c323e]">${day.date}</h3>
                            <div class="grid grid-cols-[60px_1fr_1fr] gap-x-4 border-b-2 font-bold text-center text-gray-500">
                                <div class="py-3">Time</div>
                                <div class="py-3">${room1Name}</div>
                                <div class="py-3">${room2Name}</div>
                            </div>
                        </div>
                        <div class="schedule-body">`;

                day.slots.forEach(slot => {
                    dayHtml += `<div class="grid grid-cols-[60px_1fr_1fr] gap-x-4 border-b min-h-[100px]">
                        <div class="py-4 text-center font-bold text-gray-400 text-sm">${slot.time}</div>`;
                    
                    slot.rooms.forEach(talk => {
                        dayHtml += `<div class="py-2 flex items-stretch">
                            <div class="p-2 rounded-lg w-full flex flex-col justify-center ${talk && talk.talk ? 'bg-blue-50' : ''}">
                                ${talk && talk.talk ? `
                                    <p class="font-semibold text-[#5c323e] text-sm">${talk.talk}</p>
                                    ${talk.speaker ? `<p class="text-xs text-gray-500 mt-1">${talk.speaker.Name || talk.speaker.name}<br><span class="italic">${talk.speaker.Title || talk.speaker.title}</span></p>` : ''}
                                ` : '' }
                            </div>
                        </div>`;
                    });

                    dayHtml += `</div>`;
                });

                dayHtml += `</div></div>`;
                container.innerHTML += dayHtml;
            });
        }

        function setupDebugToggles() {
            const panel = document.getElementById('debug-panel');
            if (!debugMode || !panel) return;

            panel.innerHTML = `
                <div class="flex flex-col gap-2">
                    <button id="toggle-teaser" class="px-3 py-1 text-xs bg-gray-700 text-white rounded">Toggle Teaser</button>
                </div>
            `;

            document.getElementById('toggle-teaser').addEventListener('click', () => {
                showTeaserMode = !showTeaserMode;
                renderPage();
            });
        }

        async function initializePage() {
            const [speakersData, scheduleData] = await Promise.all([
                fetchAndParseCsv(dataUrls.speakers, fallbackUrls.speakers, parseSpeakersCsv),
                fetchAndParseCsv(dataUrls.schedule, fallbackUrls.schedule, parseScheduleCsv)
            ]);
            
            allSpeakers = speakersData.length ? speakersData : localSpeakers;
            allScheduleData = scheduleData.length ? scheduleData : localSchedule;

            renderPage();
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializePage();
            setupDebugToggles();
        });
    </script>

</body>
</html>
